# Lighter量化交易系统 - Web界面使用指南

## 系统概述

本系统提供了基于React前端和FastAPI后端的Web可视化交互界面，支持跨平台使用（Windows、Linux、macOS），满足多平台兼容的需求。

## 系统架构

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   React前端     │    │   FastAPI后端   │    │   交易引擎      │
│   (端口3000)    │◄──►│   (端口8000)    │◄──►│   (核心逻辑)    │
│                 │    │                 │    │                 │
│ • 用户界面      │    │ • REST API      │    │ • 策略执行      │
│ • 实时图表      │    │ • WebSocket     │    │ • 风险管理      │
│ • 状态管理      │    │ • 数据管理      │    │ • 订单管理      │
│ • 响应式设计    │    │ • 认证授权      │    │ • 通知系统      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 功能特性

### 1. 用户界面功能
- **响应式设计**: 支持桌面、平板、手机等不同设备
- **实时数据**: WebSocket实时推送市场数据和交易状态
- **交互式图表**: 基于Recharts的K线图和技术指标
- **状态管理**: 使用Zustand进行全局状态管理
- **主题支持**: 支持明暗主题切换

### 2. 交易功能
- **策略选择**: 下拉框选择交易策略（UT Bot、均值回归、动量等）
- **参数调整**: 实时调整策略参数（杠杆、止损、止盈等）
- **交易对选择**: 支持多种数字货币交易对
- **实时监控**: 实时显示持仓、订单、盈亏等信息
- **风险控制**: 内置风险管理和资金管理功能

### 3. 数据可视化
- **K线图表**: 支持多种时间周期的K线图
- **技术指标**: 集成常用技术指标（MA、MACD、RSI等）
- **实时行情**: 实时显示价格、成交量、涨跌幅等
- **交易统计**: 详细的交易统计和性能分析

## 快速开始

### 1. 环境要求

#### 后端环境
- Python 3.8+
- FastAPI
- SQLAlchemy
- Redis
- PostgreSQL/SQLite

#### 前端环境
- Node.js 16+
- npm 8+
- React 18
- TypeScript

### 2. 一键启动

```bash
# 启动Web系统（推荐）
python start_web_system.py
```

### 3. 手动启动

#### 启动后端
```bash
cd web_backend
pip install -r requirements.txt
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

#### 启动前端
```bash
cd web_frontend
npm install
npm start
```

### 4. 访问系统

- **前端界面**: http://localhost:3000
- **后端API**: http://localhost:8000
- **API文档**: http://localhost:8000/api/docs
- **WebSocket**: ws://localhost:8000/ws

## 详细使用说明

### 1. 登录系统

1. 打开浏览器访问 http://localhost:3000
2. 输入用户名和密码
3. 点击"登录"按钮

### 2. 选择交易对

1. 在交易面板中，点击"交易对"下拉框
2. 选择要交易的数字货币（如ETH/USDT）
3. 系统会自动加载该交易对的市场数据

### 3. 选择交易策略

1. 在"交易策略"下拉框中选择策略
2. 可选择的策略包括：
   - **UT Bot策略**: 基于TradingView的UT Bot信号
   - **均值回归策略**: 价格偏离均值时的反向交易
   - **动量策略**: 跟随价格趋势的交易
   - **套利策略**: 不同市场间的价差套利

### 4. 调整策略参数

1. 选择策略后，系统会显示该策略的参数设置
2. 根据您的风险偏好调整参数：
   - **杠杆倍数**: 1-10倍杠杆
   - **止损百分比**: 触发止损的亏损比例
   - **止盈百分比**: 触发止盈的盈利比例
   - **最大持仓量**: 单次交易的最大金额

### 5. 开始交易

1. 确认所有参数设置正确
2. 点击"开始交易"按钮
3. 系统开始执行交易策略
4. 实时监控交易状态和盈亏情况

### 6. 监控交易

1. **持仓面板**: 查看当前持仓情况
2. **订单面板**: 查看待成交和已成交订单
3. **图表面板**: 查看K线图和技术指标
4. **统计面板**: 查看交易统计和性能分析

## 高级功能

### 1. 实时数据推送

系统使用WebSocket实现实时数据推送：

```javascript
// 订阅市场数据
websocket.send(JSON.stringify({
  type: 'subscribe',
  symbol: 'ETH/USDT',
  timeframe: '1m'
}));

// 接收实时数据
websocket.onmessage = (event) => {
  const data = JSON.parse(event.data);
  // 处理实时数据
};
```

### 2. 自定义策略

您可以通过API添加自定义策略：

```python
# 创建自定义策略
strategy_data = {
    "name": "我的自定义策略",
    "strategy_type": "custom",
    "description": "自定义交易策略",
    "parameters": {
        "param1": 100,
        "param2": 0.02
    }
}

response = requests.post('/api/strategies', json=strategy_data)
```

### 3. 风险控制

系统内置多层风险控制：

- **资金管理**: 限制单次交易金额
- **止损止盈**: 自动设置止损止盈价格
- **杠杆控制**: 限制最大杠杆倍数
- **持仓限制**: 限制最大持仓数量

### 4. 通知系统

系统支持多种通知方式：

- **邮件通知**: 交易完成、止损触发等
- **WebSocket推送**: 实时状态更新
- **系统日志**: 详细的操作记录

## 配置说明

### 1. 后端配置

编辑 `web_backend/.env` 文件：

```env
# 数据库配置
DATABASE_URL=sqlite:///./trading.db

# Redis配置
REDIS_URL=redis://localhost:6379

# 安全配置
SECRET_KEY=your-secret-key-here

# 交易配置
TRADING_ENABLED=true
MAX_POSITION_SIZE=0.1
MAX_LEVERAGE=5.0
```

### 2. 前端配置

编辑 `web_frontend/.env` 文件：

```env
# API地址
REACT_APP_API_URL=http://localhost:8000

# WebSocket地址
REACT_APP_WS_URL=ws://localhost:8000/ws

# 应用配置
REACT_APP_NAME=Lighter量化交易系统
```

## 故障排除

### 1. 常见问题

**问题**: 前端无法连接后端
**解决**: 检查后端是否启动，端口是否被占用

**问题**: WebSocket连接失败
**解决**: 检查防火墙设置，确保WebSocket端口开放

**问题**: 数据库连接失败
**解决**: 检查数据库配置，确保数据库服务运行

### 2. 日志查看

```bash
# 查看后端日志
tail -f web_backend/logs/web_backend.log

# 查看前端日志
# 在浏览器开发者工具中查看Console
```

### 3. 性能优化

- **数据库优化**: 定期清理历史数据
- **缓存优化**: 合理使用Redis缓存
- **前端优化**: 使用代码分割和懒加载

## 安全注意事项

### 1. 生产环境部署

- 使用HTTPS协议
- 配置防火墙规则
- 定期更新依赖包
- 使用强密码和密钥

### 2. 数据安全

- 定期备份数据库
- 加密敏感信息
- 限制API访问权限
- 监控异常操作

## 技术支持

如果您在使用过程中遇到问题，请：

1. 查看本文档的故障排除部分
2. 检查系统日志文件
3. 联系技术支持团队

## 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 支持基本的交易功能
- 实现Web界面
- 集成多种交易策略

---

**注意**: 本系统仅供学习和研究使用，实际交易请谨慎操作，注意风险控制。
